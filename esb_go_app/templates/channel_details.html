{{template "layout" .}}

{{define "content"}}
    {{if .Channel}}
        <a href="/admin/app/{{.Channel.ApplicationID}}">&larr; Назад к приложению</a>

        <h1>Канал: {{.Channel.Name}}</h1>

        {{if .StatusMessage}}
        <div class="status-message success">{{.StatusMessage}}</div>
        {{end}}
        {{if .ErrorMessage}}
        <div class="status-message error">{{.ErrorMessage}}</div>
        {{end}}

        <h2>Детали</h2>
        <table class="details-table">
            <tr><th>ID</th><td><code>{{.Channel.ID}}</code></td></tr>
            <tr><th>Application ID</th><td><code>{{.Channel.ApplicationID}}</code></td></tr>
            <tr><th>Название</th><td>{{.Channel.Name}}</td></tr>
            <tr><th>Направление</th><td>{{.Channel.Direction}}</td></tr>
            <tr><th>Назначение (Очередь)</th><td><code>{{.Channel.Destination}}</code></td></tr>
            <tr><th>Режим Fan-out</th><td>{{if .Channel.FanoutMode}}✓{{else}}✗{{end}}</td></tr>
            <tr><th>Создан</th><td>{{.Channel.CreatedAt.Format "2006-01-02 15:04:05"}}</td></tr>
        </table>

        <h2 style="margin-top: 2em;">Редактировать канал</h2>
        <form action="/admin/app/{{.Channel.ApplicationID}}/channel/{{.Channel.ID}}/update" method="POST">
            <div class="form-group">
                <label for="name">Название канала:</label>
                <input type="text" id="name" name="name" value="{{.Channel.Name}}" required>
            </div>
            <div class="form-group">
                <label for="destination">Назначение (очередь):</label>
                <input type="text" id="destination" name="destination" value="{{.Channel.Destination}}" required>
            </div>
            <div class="form-group">
                <label for="direction">Направление:</label>
                <select id="direction" name="direction">
                    <option value="inbound" {{if eq .Channel.Direction "inbound"}}selected{{end}}>inbound</option>
                    <option value="outbound" {{if eq .Channel.Direction "outbound"}}selected{{end}}>outbound</option>
                </select>
            </div>
            <div class="form-group">
                <input type="checkbox" id="fanout_mode" name="fanout_mode" value="on" {{if .Channel.FanoutMode}}checked{{end}}>
                <label for="fanout_mode">Режим Fan-out (раздавать копии подписчикам)</label>
            </div>
            <button type="submit" class="btn btn-primary">Обновить канал</button>
        </form>

    {{else}}
        <p>Канал не найден.</p>
    {{end}}
{{end}}